# 非機能要件定義書

| 項目 | 内容 |
|------|------|
| プロジェクト名 | PostBlog - 高速ブログ投稿支援アプリ |
| バージョン | 1.0.0 |
| 作成日 | 2026-02-19 |
| 最終更新日 | 2026-02-19 |

---

## 1. パフォーマンス要件

### 1.1 応答時間

| 項目 | 要件 | 計測条件 |
|------|------|---------|
| アプリ起動 | 1秒以内 | ウィンドウ表示まで |
| 画面遷移 | 体感ゼロ秒（100ms以内） | 画面切り替え完了まで |
| ヒアリング質問表示 | AI応答待ち以外は即時 | ユーザー回答送信後 |
| 記事プロトタイプ生成 | ストリーミング表示で即時開始 | 生成ボタン押下後 |
| 記事投稿 | 5秒以内 | 投稿ボタン押下後（ネットワーク依存） |
| 記事編集（キー入力） | 16ms以内（60fps） | キー入力からUI反映まで |

### 1.2 起動時間最適化方針

- 遅延読み込み（Lazy Loading）: 画面遷移先のコンポーネントは遅延読み込み
- キャッシュ活用: 設定情報やテンプレートはキャッシュから読み込み
- 非同期初期化: サービス認証チェック等はバックグラウンドで実行

---

## 2. 可用性要件

### 2.1 動作環境

| 項目 | 要件 |
|------|------|
| OS | Windows 10/11 |
| Python | 3.12以上 |
| メモリ | 最小512MB、推奨1GB |
| ディスク | 100MB以上の空き容量 |
| ネットワーク | インターネット接続必須（API通信用） |

### 2.2 オフライン対応

- 記事の編集・下書き保存はオフラインで可能
- ヒアリング（LLM利用）と記事投稿にはオンライン接続が必要
- オフライン時は適切なエラーメッセージを表示する

---

## 3. セキュリティ要件

### 3.1 認証情報の保護

| 項目 | 要件 |
|------|------|
| APIキー保存 | OS標準のキーチェーン/資格情報マネージャーを使用 |
| 暗号化 | 認証トークンはAES-256で暗号化して保存 |
| メモリ上の保護 | 使用後は認証情報をメモリから消去 |
| ログ出力 | 認証情報はログに出力しない |

### 3.2 通信セキュリティ

| 項目 | 要件 |
|------|------|
| API通信 | HTTPS（TLS 1.2以上）のみ使用 |
| トークン送信 | AuthorizationヘッダーまたはBearer Token形式 |

### 3.3 データ保護

| 項目 | 要件 |
|------|------|
| ローカルデータ | ユーザーのホームディレクトリ配下に保存 |
| 設定ファイル | 適切なファイルパーミッションを設定 |
| 一時ファイル | セッション終了時に削除 |

---

## 4. 保守性要件

### 4.1 コード品質

| 項目 | 要件 |
|------|------|
| テストカバレッジ | 90%以上（ロジック層は100%） |
| 型チェック | mypy strict モード |
| リンター | ruff によるコード品質チェック |
| アーキテクチャ | GUI / ロジック / データの3層分離 |

### 4.2 拡張性

| 項目 | 要件 |
|------|------|
| ブログサービス追加 | プラグイン方式で新規サービスを追加可能 |
| ブログ種別追加 | ヒアリングテンプレートの追加で種別を拡張可能 |
| LLMプロバイダー変更 | 抽象化レイヤーにより他のLLMへ切替可能 |

### 4.3 ログ出力

| 項目 | 要件 |
|------|------|
| ログレベル | DEBUG / INFO / WARNING / ERROR / CRITICAL |
| ログ出力先 | `logs/` ディレクトリ（日次ローテーション） |
| ログ保持期間 | 30日間 |
| ログフォーマット | タイムスタンプ、レベル、モジュール名、関数名、行番号、メッセージ |

---

## 5. ユーザビリティ要件

### 5.1 UI/UX原則

| 原則 | 説明 |
|------|------|
| 直感的操作 | 初回利用時にマニュアル不要で操作できる |
| 最小ステップ | インプットから投稿まで最小限のステップで完了 |
| フィードバック | すべての操作に対して即座にフィードバックを返す |
| エラー回復 | エラー発生時に明確な回復手順を提示する |

### 5.2 アクセシビリティ

| 項目 | 要件 |
|------|------|
| フォントサイズ | 変更可能 |
| テーマ | ライト/ダークモード対応 |
| キーボード操作 | 主要操作はキーボードショートカットで実行可能 |

---

## 6. 信頼性要件

### 6.1 データ保全

| 項目 | 要件 |
|------|------|
| 自動保存 | 記事編集中は30秒ごとに自動保存 |
| クラッシュリカバリ | アプリ異常終了時に編集中データを復元可能 |
| 投稿失敗時 | 記事データを保持し、リトライ可能 |

### 6.2 エラーハンドリング

| エラー種別 | 対応方針 |
|-----------|---------|
| ネットワークエラー | リトライボタン表示、オフライン保存を提案 |
| API認証エラー | 再認証フローへ誘導 |
| LLM応答エラー | リトライ、または手動入力への切替を提案 |
| データ保存エラー | エラー内容を表示し、代替保存先を提案 |

---

## 7. 技術スタック

| カテゴリ | 技術 |
|---------|------|
| 言語 | Python 3.12+ |
| GUIフレームワーク | CustomTkinter |
| LLM API | OpenAI API（GPT-4o） |
| パッケージ管理 | uv |
| データベース | SQLite（投稿履歴等） |
| 認証情報管理 | keyring（OS標準キーチェーン） |
| Markdownパーサー | markdown / mistune |
| HTTP クライアント | httpx（非同期対応） |
| テスト | pytest / pytest-cov |
| リンター / フォーマッター | ruff |
| 型チェック | mypy |

---

## 8. 制約事項

### 8.1 技術的制約

- CustomTkinterの制約により、リッチなMarkdownプレビューの実現に限界がある場合がある
- OpenAI APIの応答速度はネットワーク環境とAPIの負荷状況に依存する
- note、WantedlyはAPI未提供のため、直接投稿機能の実装が不可能

### 8.2 運用上の制約

- ユーザーがOpenAI APIキーを自身で取得する必要がある
- 各ブログサービスの認証設定はユーザーが個別に行う必要がある
- API利用料金（OpenAI）はユーザー負担

---

## 9. 変更履歴

| 日付 | バージョン | 変更内容 | 担当 |
|------|-----------|---------|------|
| 2026-02-19 | 1.0.0 | 初版作成 | - |
